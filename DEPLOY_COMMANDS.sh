#!/bin/bash

# 🚀 Пошаговый деплой в Telegram Mini App
# Просто скопируйте и вставьте эти команды в терминал!

echo "
╔══════════════════════════════════════════════════════════════╗
║                                                              ║
║         🎙️ ДЕПЛОЙ ГЕНЕРАТОРА ПОДКАСТОВ                      ║
║                                                              ║
╚══════════════════════════════════════════════════════════════╝
"

# Переходим в директорию проекта
cd /Users/evgenia.zhuravishkina/PODCAST

echo "📂 Текущая директория: $(pwd)"
echo ""

# Проверяем, что Vercel установлен
if ! command -v vercel &> /dev/null; then
    echo "❌ Vercel не найден. Устанавливаю..."
    npm install -g vercel
fi

echo "✅ Vercel установлен"
echo ""

# Показываем инструкции
echo "═══════════════════════════════════════════════════════════════"
echo "📋 ШАГ 1: ВХОД В VERCEL"
echo "═══════════════════════════════════════════════════════════════"
echo ""
echo "Сейчас откроется браузер для входа в Vercel."
echo "Выберите GitHub или Google для входа."
echo ""
read -p "Нажмите Enter для продолжения..."

# Вход в Vercel
vercel login

if [ $? -ne 0 ]; then
    echo ""
    echo "❌ Ошибка входа в Vercel!"
    echo "Попробуйте вручную: vercel login"
    exit 1
fi

echo ""
echo "✅ Вход выполнен успешно!"
echo ""

# Деплой
echo "═══════════════════════════════════════════════════════════════"
echo "📋 ШАГ 2: ДЕПЛОЙ ПРИЛОЖЕНИЯ"
echo "═══════════════════════════════════════════════════════════════"
echo ""
echo "Сейчас начнется деплой..."
echo ""

vercel --prod --yes

if [ $? -eq 0 ]; then
    echo ""
    echo "═══════════════════════════════════════════════════════════════"
    echo "🎉 ДЕПЛОЙ УСПЕШЕН!"
    echo "═══════════════════════════════════════════════════════════════"
    echo ""
    echo "📋 СЛЕДУЮЩИЕ ШАГИ:"
    echo ""
    echo "1️⃣  СКОПИРУЙТЕ Production URL выше (https://...)"
    echo ""
    echo "2️⃣  Откройте Telegram → @BotFather"
    echo ""
    echo "3️⃣  Отправьте: /newbot"
    echo "    Название: Podcast Generator"
    echo "    Username: your_podcast_bot"
    echo ""
    echo "4️⃣  Отправьте: /newapp"
    echo "    Выберите вашего бота"
    echo "    Название: Podcast Generator"
    echo "    URL: ВСТАВЬТЕ СКОПИРОВАННЫЙ URL"
    echo ""
    echo "5️⃣  Откройте бота → кнопка меню → готово! 🎉"
    echo ""
    echo "═══════════════════════════════════════════════════════════════"
else
    echo ""
    echo "❌ Ошибка деплоя!"
    echo "Попробуйте вручную: vercel --prod"
    exit 1
fi

