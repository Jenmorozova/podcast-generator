#!/bin/bash

# üöÄ –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –≤ Telegram Mini App

echo "üéôÔ∏è –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ü–æ–¥–∫–∞—Å—Ç–æ–≤ - –î–µ–ø–ª–æ–π –≤ Telegram"
echo "=========================================="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Vercel
if ! command -v vercel &> /dev/null
then
    echo "‚ùå Vercel CLI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é Vercel CLI..."
    npm install -g vercel
fi

echo "‚úÖ Vercel CLI –Ω–∞–π–¥–µ–Ω"
echo ""

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
echo "üî® –°–æ–±–∏—Ä–∞—é –ø—Ä–æ–µ–∫—Ç..."
npm run build

if [ $? -ne 0 ]; then
    echo "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏!"
    exit 1
fi

echo "‚úÖ –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–±—Ä–∞–Ω"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
echo "üîê –ü—Ä–æ–≤–µ—Ä—è—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ Vercel..."
vercel whoami &> /dev/null

if [ $? -ne 0 ]; then
    echo "‚ùå –í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Vercel"
    echo "üîë –ó–∞–ø—É—Å–∫–∞—é –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏..."
    vercel login
fi

echo "‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞"
echo ""

# –î–µ–ø–ª–æ–π
echo "üöÄ –î–µ–ø–ª–æ—é –Ω–∞ Vercel..."
echo ""

vercel --prod --yes

if [ $? -eq 0 ]; then
    echo ""
    echo "=========================================="
    echo "‚úÖ –î–ï–ü–õ–û–ô –£–°–ü–ï–®–ï–ù!"
    echo "=========================================="
    echo ""
    echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
    echo ""
    echo "1Ô∏è‚É£  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ Production URL –≤—ã—à–µ"
    echo "2Ô∏è‚É£  –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather –≤ Telegram"
    echo "3Ô∏è‚É£  –û—Ç–ø—Ä–∞–≤—å—Ç–µ: /newbot"
    echo "4Ô∏è‚É£  –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞"
    echo "5Ô∏è‚É£  –û—Ç–ø—Ä–∞–≤—å—Ç–µ: /newapp"
    echo "6Ô∏è‚É£  –í—Å—Ç–∞–≤—å—Ç–µ Production URL"
    echo "7Ô∏è‚É£  –ì–æ—Ç–æ–≤–æ! üéâ"
    echo ""
    echo "üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: START_HERE.md"
    echo ""
else
    echo ""
    echo "‚ùå –û—à–∏–±–∫–∞ –¥–µ–ø–ª–æ—è!"
    echo "üìñ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é: vercel login && vercel --prod"
    exit 1
fi

